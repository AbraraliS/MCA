<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>To-Do List</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f0f0f0;
      margin: 0;
      padding: 0;
      color: #333;
      min-height: 100vh;
      transition: background 0.4s, color 0.4s;
    }
    .container {
      max-width: 600px;
      margin: 60px auto;
      background: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      padding: 40px;
      position: relative;
      transition: background 0.4s, box-shadow 0.4s;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 2.5rem;
      transition: color 0.4s;
    }
    .subtitle {
      text-align: center;
      color: #7f8c8d;
      font-size: 1.2rem;
      margin-bottom: 30px;
      transition: color 0.4s;
    }
    .input-row {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: center;
    }
    #task-input {
      flex: 2;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #bdc3c7;
      font-size: 1rem;
      background: #ecf0f1;
      transition: background 0.4s, color 0.4s, border 0.4s;
    }
    #task-input:focus {
      border: 1px solid #3498db;
      outline: none;
      background: #ffffff;
    }
    #priority-input, #due-date-input {
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #bdc3c7;
      font-size: 1rem;
      background: #ecf0f1;
      transition: background 0.4s, color 0.4s, border 0.4s;
    }
    #add-btn {
      background-color: #3498db;
      color: #ffffff;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
    }
    #add-btn:hover {
      background-color: #2980b9;
    }
    ul#todo-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    li.task {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #ffffff;
      margin-bottom: 10px;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      font-size: 1.1rem;
      cursor: pointer;
      transition: background 0.4s, color 0.4s;
    }
    li.task.completed {
      text-decoration: line-through;
      color: #bdc3c7;
      background: #ecf0f1;
    }
    .actions {
      display: flex;
      gap: 8px;
    }
    .actions button {
      border: none;
      background: none;
      cursor: pointer;
      font-size: 1.2rem;
      color: #3498db;
      transition: color 0.3s;
    }
    .actions button:hover {
      color: #2980b9;
    }
    .filters {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }
    .filters button {
      background-color: #3498db;
      color: #ffffff;
      border: none;
      border-radius: 5px;
      padding: 10px 15px;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
    }
    .filters button.active, .filters button:hover {
      background-color: #2980b9;
      color: #fff;
    }
    .clear-btn {
      display: block;
      margin: 20px auto;
      background-color: #e74c3c;
      color: #ffffff;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    .clear-btn:hover {
      background-color: #c0392b;
    }
    .stats {
      text-align: center;
      margin: 20px 0;
      color: #2c3e50;
      font-weight: bold;
      transition: color 0.4s;
    }
    .priority {
      margin-left: 8px;
      font-size: 0.95em;
      font-weight: bold;
      padding: 2px 8px;
      border-radius: 8px;
      background: #f9e79f;
      color: #b9770e;
      border: 1px solid #f7ca18;
      vertical-align: middle;
      margin-right: 4px;
    }
    .priority.high {
      background: #f5b7b1;
      color: #c0392b;
      border-color: #e74c3c;
    }
    .priority.low {
      background: #d4efdf;
      color: #229954;
      border-color: #27ae60;
    }
    .due-date {
      margin-left: 10px;
      font-size: 0.93em;
      color: #1976d2;
      font-weight: 500;
      background: #e3f2fd;
      border-radius: 6px;
      padding: 2px 8px;
      border: 1px solid #90caf9;
      vertical-align: middle;
    }
    /* Dark mode styles */
    body.dark-mode {
      background-color: #23272f;
      color: #e0e0e0;
    }
    .dark-mode .container {
      background: #2c3e50;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    }
    .dark-mode h1 {
      color: #f9e79f;
    }
    .dark-mode .subtitle {
      color: #b2bec3;
    }
    .dark-mode #task-input,
    .dark-mode #priority-input,
    .dark-mode #due-date-input {
      background: #23272f;
      color: #e0e0e0;
      border-color: #34495e;
    }
    .dark-mode #task-input:focus,
    .dark-mode #priority-input:focus,
    .dark-mode #due-date-input:focus {
      background: #23272f;
      color: #fff;
      border-color: #2980b9;
    }
    .dark-mode #add-btn {
      background-color: #2980b9;
      color: #fff;
    }
    .dark-mode #add-btn:hover {
      background-color: #3498db;
      color: #fffbe6;
    }
    .dark-mode ul#todo-list {
      background: transparent;
    }
    .dark-mode li.task {
      background: #34495e;
      color: #e0e0e0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.25);
    }
    .dark-mode li.task.completed {
      background: #23272f;
      color: #7f8c8d;
    }
    .dark-mode .actions button {
      color: #f9e79f;
    }
    .dark-mode .actions button:hover {
      color: #f5b7b1;
    }
    .dark-mode .filters button {
      background-color: #23272f;
      color: #f9e79f;
    }
    .dark-mode .filters button.active,
    .dark-mode .filters button:hover {
      background-color: #2980b9;
      color: #fff;
    }
    .dark-mode .clear-btn {
      background-color: #c0392b;
      color: #fff;
    }
    .dark-mode .clear-btn:hover {
      background-color: #e74c3c;
    }
    .dark-mode .stats {
      color: #f9e79f;
    }
    .dark-mode .priority {
      background: #7f8c8d;
      color: #f9e79f;
      border-color: #f9e79f;
    }
    .dark-mode .priority.high {
      background: #c0392b;
      color: #fff;
      border-color: #e74c3c;
    }
    .dark-mode .priority.low {
      background: #229954;
      color: #fff;
      border-color: #27ae60;
    }
    .dark-mode .due-date {
      background: #23272f;
      color: #90caf9;
      border-color: #2980b9;
    }
    .theme-toggle {
      position: absolute;
      top: 18px;
      right: 24px;
      background: #ecf0f1;
      border: 1.5px solid #bdc3c7;
      border-radius: 50%;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.3rem;
      transition: background 0.2s, border 0.2s, color 0.2s;
      box-shadow: 0 2px 8px #bdc3c7;
      z-index: 2;
    }
    .theme-toggle:hover {
      background: #3498db;
      color: #fff;
      border-color: #2980b9;
    }
    .dark-mode .theme-toggle {
      background: #23272f;
      color: #f9e79f;
      border-color: #34495e;
      box-shadow: 0 2px 8px #23272f;
    }
    .dark-mode .theme-toggle:hover {
      background: #2980b9;
      color: #fff;
      border-color: #f9e79f;
    }
    @media (max-width: 700px) {
      .container {
        padding: 18px 5px 18px 5px;
        max-width: 98vw;
      }
      .input-row {
        flex-direction: column;
        gap: 8px;
      }
      .theme-toggle {
        top: 10px;
        right: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="theme-toggle" id="theme-toggle" title="Toggle Light/Dark Mode">üåô</button>
    <h1>To-Do List</h1>
    <div class="subtitle">
      Organize your tasks efficiently!
    </div>
    <div class="input-row">
      <input type="text" id="task-input" placeholder="Add a new task..." />
      <select id="priority-input" title="Priority">
        <option value="normal">Priority</option>
        <option value="high">High</option>
        <option value="normal">Normal</option>
        <option value="low">Low</option>
      </select>
      <input type="date" id="due-date-input" title="Due Date" />
      <button id="add-btn" title="Add Task">Add</button>
    </div>
    <div class="filters">
      <button class="active" data-filter="all">All</button>
      <button data-filter="active">Active</button>
      <button data-filter="completed">Completed</button>
      <button data-filter="high">High Priority</button>
    </div>
    <ul id="todo-list"></ul>
    <div class="stats" id="stats"></div>
    <button class="clear-btn" id="clear-completed">Clear Completed</button>
  </div>
  <script>
    // Helper functions for localStorage
    function getTasks() {
      return JSON.parse(localStorage.getItem('tasks') || '[]');
    }
    function saveTasks(tasks) {
      localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    // DOM elements
    const taskInput = document.getElementById('task-input');
    const priorityInput = document.getElementById('priority-input');
    const dueDateInput = document.getElementById('due-date-input');
    const addBtn = document.getElementById('add-btn');
    const todoList = document.getElementById('todo-list');
    const filterBtns = document.querySelectorAll('.filters button');
    const clearBtn = document.getElementById('clear-completed');
    const stats = document.getElementById('stats');
    const themeToggle = document.getElementById('theme-toggle');
    let tasks = getTasks();
    let filter = 'all';

    function renderTasks() {
      todoList.innerHTML = '';
      let filtered = tasks;
      if (filter === 'active') filtered = tasks.filter(t => !t.completed);
      if (filter === 'completed') filtered = tasks.filter(t => t.completed);
      if (filter === 'high') filtered = tasks.filter(t => t.priority === 'high' && !t.completed);

      filtered.forEach((task, idx) => {
        const li = document.createElement('li');
        li.className = 'task' + (task.completed ? ' completed' : '');
        // Checkbox
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = task.completed;
        checkbox.title = "Mark as completed";
        checkbox.addEventListener('change', () => {
          task.completed = !task.completed;
          saveTasks(tasks);
          renderTasks();
        });
        // Task text
        const span = document.createElement('span');
        span.textContent = task.text;
        span.style.flex = '1';
        li.appendChild(checkbox);
        li.appendChild(span);

        // Priority badge
        if (task.priority && task.priority !== 'normal') {
          const badge = document.createElement('span');
          badge.className = 'priority ' + task.priority;
          badge.textContent = task.priority.charAt(0).toUpperCase() + task.priority.slice(1);
          li.appendChild(badge);
        }
        // Due date
        if (task.dueDate) {
          const due = document.createElement('span');
          due.className = 'due-date';
          due.textContent = 'Due: ' + task.dueDate;
          li.appendChild(due);
        }

        // Actions
        const actions = document.createElement('div');
        actions.className = 'actions';
        // Edit button
        const editBtn = document.createElement('button');
        editBtn.title = "Edit";
        editBtn.innerHTML = '‚úèÔ∏è';
        editBtn.addEventListener('click', () => startEdit(idx));
        actions.appendChild(editBtn);
        // Delete button
        const delBtn = document.createElement('button');
        delBtn.title = "Delete";
        delBtn.innerHTML = 'üóëÔ∏è';
        delBtn.addEventListener('click', () => {
          tasks.splice(idx, 1);
          saveTasks(tasks);
          renderTasks();
        });
        actions.appendChild(delBtn);
        li.appendChild(actions);

        // Double-click to edit
        li.addEventListener('dblclick', () => startEdit(idx));
        todoList.appendChild(li);
      });

      // Stats
      const total = tasks.length;
      const completed = tasks.filter(t => t.completed).length;
      const active = total - completed;
      stats.innerHTML = `Total: ${total} | Active: ${active} | Completed: ${completed}`;
    }

    function addTask() {
      const text = taskInput.value.trim();
      const priority = priorityInput.value;
      const dueDate = dueDateInput.value;
      if (!text) return;
      tasks.push({ text, completed: false, priority: priority || 'normal', dueDate: dueDate || '' });
      saveTasks(tasks);
      taskInput.value = '';
      priorityInput.value = 'normal';
      dueDateInput.value = '';
      renderTasks();
    }

    function startEdit(idx) {
      tasks[idx].editing = true;
      renderTasks();
    }

    function finishEdit(idx, newText, newPriority, newDueDate) {
      if (newText !== null && newText !== undefined && newText.trim()) {
        tasks[idx].text = newText.trim();
      }
      if (newPriority) {
        tasks[idx].priority = newPriority;
      }
      if (newDueDate !== null && newDueDate !== undefined) {
        tasks[idx].dueDate = newDueDate;
      }
      delete tasks[idx].editing;
      saveTasks(tasks);
      renderTasks();
    }

    function cancelEdit(idx) {
      delete tasks[idx].editing;
      renderTasks();
    }

    addBtn.onclick = addTask;
    taskInput.addEventListener('keydown', e => {
      if (e.key === 'Enter') addTask();
    });

    filterBtns.forEach(btn => {
      btn.onclick = () => {
        filterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        filter = btn.getAttribute('data-filter');
        renderTasks();
      };
    });

    clearBtn.onclick = () => {
      tasks = tasks.filter(t => !t.completed);
      saveTasks(tasks);
      renderTasks();
    };

    // Dark mode toggle
    let dark = false;
    themeToggle.onclick = () => {
      dark = !dark;
      document.body.classList.toggle('dark-mode', dark);
      themeToggle.textContent = dark ? '‚òÄÔ∏è' : 'üåô';
    };

    // Initial render
    renderTasks();
  </script>
</body>
</html>